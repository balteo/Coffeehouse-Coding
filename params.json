{"name":"Coffeehouse Coding","tagline":"Relying efficiently upon the Spring test context cache in order to speed up you Spring integration tests","body":"Using the `SpringJUnit4ClassRunner` in your integration tests will automatically create a test context cache that will cache Spring application context instances for you (see` org.springframework.test.context.ContextCache`).\r\n\r\nThe number of instances in the test context cache will be mainly determined by the number of distinct context configurations used by your integration tests.\r\n\r\nSay you have the three following test cases:\r\n\r\n    @RunWith(SpringJUnit4ClassRunner.class)\r\n    @ContextConfiguration(classes = { ConfigA.class , ConfigB.class })\r\n    public class FirstTestCase {\r\n    ...\r\n\r\n    @RunWith(SpringJUnit4ClassRunner.class)\r\n    @ContextConfiguration(classes = { ConfigB.class})\r\n    public class SecondTestCase {\r\n    ...\r\n    \r\n    @RunWith(SpringJUnit4ClassRunner.class)\r\n    @ContextConfiguration(classes = { ConfigA.class , ConfigB.class })\r\n    public class ThirdTestCase {\r\n    ...\r\n\r\nThe context configuration for _**FirstTestCase**_ will be cached and reused by **_ThirdTestCase_** because the context configuration are the same. The test context cache will therefore contain **2 entries** corresponding to the following context configurations:\r\n\r\nThis will be used by _**FirstTestCase**_ and _**ThirdTestCase**_:\r\n\r\n    @ContextConfiguration(classes = { ConfigA.class , ConfigB.class }) \r\n\r\nThis will be used by _**SecondTestCase**_ only:\r\n\r\n    @ContextConfiguration(classes = { ConfigB.class}) \r\n\r\n\r\nWorking out manually how many entries the test context cache contains for your application tests can be quite challenging but the upcoming versions of Spring (4.1.2, 4.0.8, and 3.2.12) will have a neat feature that allowing you to gain insight into your test context cache usage.\r\n\r\nIn order to use this feature, you just need to enable the debug log level for the following package: “**org.springframework.test.context.cache**” and Spring will start logging information such as:\r\n\r\n    2014-11-10 09:48:16.674 DEBUG 1740 --- [    Test worker] org.springframework.test.context.cache   : Spring test ApplicationContext cache statistics: [ContextCache@2067b93c size = 2, hitCount = 142, missCount = 2, parentContextCount = 0]\r\n    2014-11-10 09:48:16.674 DEBUG 1740 --- [    Test worker] org.springframework.test.context.cache   : Spring test ApplicationContext cache statistics: [ContextCache@2067b93c size = 2, hitCount = 143, missCount = 2, parentContextCount = 0]\r\n    2014-11-10 09:48:16.696 DEBUG 1740 --- [    Test worker] org.springframework.test.context.cache   : Spring test ApplicationContext cache statistics: [ContextCache@2067b93c size = 2, hitCount = 144, missCount = 2, parentContextCount = 0]\r\n\r\n\r\nThis is actually log output taken from an application I am currently working on. You can see that the size of my test context cache is **2** and that the cache is actually reusing those two instances and incrementing the hit count: **142**, **143**, **144**.\r\n\r\n**Conclusion**: being aware of the existence of the Spring test context cache and understanding how the number of distinct Spring context configurations determine how many entries the cache eventually contains can help you organize more efficiently the structure of your spring integration tests and make them run much faster.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}